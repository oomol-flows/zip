# OOMOL 平台 ZIP 操作工具

一个为 OOMOL 工作流平台提供的综合 ZIP 文件操作任务块集合。该包提供了 15 个专用任务块，涵盖 ZIP 文件操作的各个方面，从基础的压缩和解压到高级功能如加密、编码转换和归档管理。

## 🎯 概述

这个 OOMOL 包使用户能够通过可视化工作流界面处理 ZIP 归档文件。每个任务块都设计得直观、可靠且功能丰富，支持基本文件操作和高级用例，如加密归档、批处理和跨平台编码兼容性。

## ✨ 主要特性

- **🔐 完整加密支持** - AES 128/192/256 位加密，创建安全归档
- **🌏 编码兼容性** - 中文/亚洲文件名的自动检测和转换
- **📊 详细分析** - 压缩统计、文件计数和处理摘要
- **🔄 批处理** - 高效处理多个文件和文件夹
- **🛠️ 高级操作** - 合并、拆分、验证和选择性解压归档
- **📋 丰富的 UI 集成** - 文件选择器、保存对话框和进度指示器
- **⚡ 高性能** - 针对大文件和复杂操作进行优化

## 📦 任务块概述

### 压缩任务（5 个任务块）

#### `zip-create` - 基础归档创建
使用标准压缩从文件或文件夹创建 ZIP 归档。
- **输入**：源路径、输出路径、压缩选项
- **输出**：ZIP 文件路径、压缩统计
- **用例**：通用文件归档

#### `zip-create-encrypted` - 加密归档创建
使用 AES 加密创建受密码保护的 ZIP 归档。
- **输入**：源路径、密码、加密强度（128/192/256）
- **输出**：带压缩指标的加密 ZIP 文件
- **用例**：安全文件存储和传输

#### `zip-compress-level` - 自定义压缩
使用可配置的压缩级别和方法创建 ZIP 归档。
- **输入**：压缩级别（0-9）、方法（DEFLATED/STORED/BZIP2/LZMA）
- **输出**：带详细压缩时间的 ZIP 文件
- **用例**：优化文件大小与处理时间

#### `zip-add-files` - 追加到归档
向现有 ZIP 归档添加新文件，无需重新创建。
- **输入**：现有 ZIP 路径、要添加的文件、冲突处理
- **输出**：带添加摘要的修改 ZIP
- **用例**：增量归档更新

#### `zip-batch-compress` - 批量压缩
一次操作将多个文件夹压缩为单独的 ZIP 文件。
- **输入**：文件夹列表、输出目录、命名模式
- **输出**：多个 ZIP 文件和批处理摘要
- **用例**：组织大量文件夹集合

### 解压任务（4 个任务块）

#### `zip-extract` - 标准解压
将 ZIP 归档内容解压到指定目录。
- **输入**：ZIP 路径、输出目录、结构选项
- **输出**：解压文件列表和统计
- **用例**：常规文件恢复和访问

#### `zip-extract-encrypted` - 解密和解压
使用验证解压受密码保护的 ZIP 归档。
- **输入**：ZIP 路径、密码、验证选项
- **输出**：带密码验证状态的解压文件
- **用例**：访问安全归档

#### `zip-extract-selective` - 部分解压
从 ZIP 归档中仅解压特定文件。
- **输入**：ZIP 路径、文件选择列表、结构保持
- **输出**：选择性解压文件和跳过报告
- **用例**：检索特定文件而不完全解压

#### `zip-extract-flat` - 平铺解压
将文件解压到平铺目录结构，忽略子目录。
- **输入**：ZIP 路径、文件过滤器、冲突解决
- **输出**：带冲突处理的平铺文件结构
- **用例**：从复杂目录结构合并文件

### 信息任务（3 个任务块）

#### `zip-list-contents` - 归档检查
列出和分析 ZIP 归档内容，包含详细元数据。
- **输入**：ZIP 路径、排序选项、详细级别
- **输出**：文件列表、统计和结构化数据
- **用例**：归档探索和内容验证

#### `zip-get-info` - 归档元数据
提取 ZIP 文件及其属性的综合信息。
- **输入**：ZIP 路径、校验和计算选项
- **输出**：详细元数据、压缩统计、文件分析
- **用例**：归档分析和质量评估

#### `zip-validate` - 完整性验证
验证 ZIP 文件完整性、测试解压和验证校验和。
- **输入**：ZIP 路径、验证深度、测试选项
- **输出**：验证结果、损坏报告、完整性状态
- **用例**：质量保证和归档健康检查

### 高级操作（3 个任务块）

#### `zip-merge` - 归档合并
将多个 ZIP 归档合并到单个合并文件中。
- **输入**：ZIP 文件列表、冲突解决、密码处理
- **输出**：带操作摘要的合并归档
- **用例**：组合相关归档或合并备份

#### `zip-split-by-size` - 归档拆分
根据大小限制将大型 ZIP 文件拆分为较小块。
- **输入**：ZIP 路径、每块最大大小、命名模式
- **输出**：多个拆分文件和大小分布
- **用例**：为大小受限的传输或存储准备归档

#### `zip-convert-encoding` - 文件名编码修复
修复文件名编码问题，特别是中文和亚洲字符。
- **输入**：ZIP 路径、源/目标编码、自动检测选项
- **输出**：带转换统计的重新编码归档
- **用例**：跨平台兼容性和国际化

## 🚀 安装和设置

### 先决条件
- OOMOL 平台
- Python 3.10+
- Poetry（用于依赖管理）

### 安装
```bash
# 克隆或下载此包到您的 OOMOL 工作区
git clone <repository-url> zip-operations

# 安装依赖
cd zip-operations
poetry install --no-root
```

### 依赖项
- `pyzipper` (0.3.6+) - 带加密支持的 ZIP 操作
- `pandas` (2.0.0+) - 数据处理和分析
- `chardet` (5.0.0+) - 字符编码检测
- `oocana` - OOMOL 平台集成

## 📋 使用示例

### 基本工作流：压缩 → 验证 → 解压
1. 使用 `zip-create` 压缩项目文件
2. 使用 `zip-validate` 验证归档完整性
3. 使用 `zip-extract` 在需要时恢复文件

### 安全工作流：加密 → 验证 → 解密
1. 使用 `zip-create-encrypted` 设置强密码
2. 使用 `zip-get-info` 验证加密状态
3. 使用 `zip-extract-encrypted` 通过密码访问

### 批处理工作流：批量 → 合并 → 拆分
1. 使用 `zip-batch-compress` 处理多个文件夹
2. 使用 `zip-merge` 合并相关归档
3. 使用 `zip-split-by-size` 创建适于分发的块

### 跨平台工作流：转换 → 验证 → 解压
1. 使用 `zip-convert-encoding` 修复文件名问题
2. 使用 `zip-validate` 确保兼容性
3. 使用 `zip-extract` 进行清洁的文件恢复

## 🛠️ 技术详情

### 支持的 ZIP 功能
- 标准 ZIP 压缩（DEFLATED、STORED、BZIP2、LZMA）
- AES 加密（128/192/256 位）
- Unicode 文件名支持
- 大文件支持（通过 ZIP64 支持 >4GB）
- 目录结构和元数据保持

### 编码支持
- UTF-8（主要）
- GBK/GB2312（简体中文）
- Big5（繁体中文）
- Shift_JIS（日语）
- EUC-KR（韩语）
- CP437（DOS/Windows 传统）
- 混合编码的自动检测

### 性能特征
- 针对速度和压缩率进行优化
- 大文件的内存高效处理
- 适用时的并行处理支持
- 长操作的渐进式反馈

## 🔧 配置选项

每个任务块通过其 UI 提供广泛的配置：

- **文件选择**：目录选择器、文件过滤器、保存对话框
- **安全选项**：密码字段、加密强度选择
- **处理选项**：压缩级别、批处理设置、命名模式
- **输出控制**：详细日志、进度跟踪、错误处理

## 📊 输出数据

所有任务块提供结构化输出数据，包括：

- **操作结果**：成功/失败状态、处理文件计数
- **性能指标**：压缩率、处理时间、文件大小
- **详细报告**：包含综合操作数据的 Pandas DataFrame
- **错误信息**：详细错误消息和故障排除指导

## 🤝 贡献

此包遵循 OOMOL 开发标准：

1. 每个任务块包含 `task.oo.yaml` 配置和 `__init__.py` 实现
2. 所有输入/输出都通过 JSON 模式定义正确类型化
3. 错误处理包括用户友好的消息和恢复建议
4. UI 组件使用适当的组件进行文件选择和数据输入
5. 文档包含综合参数描述

## 📄 许可证

此项目根据 MIT 许可证授权 - 详见 LICENSE 文件。

## 🆘 支持

- **文档**：任务块描述和参数详情
- **示例**：示例工作流和常见用例
- **问题**：通过 OOMOL 平台报告错误或请求功能
- **社区**：与其他用户分享工作流和最佳实践

---

**为 OOMOL 平台构建** - 通过强大的 ZIP 归档操作赋能可视化工作流自动化。